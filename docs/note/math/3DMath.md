---
id: 3DMath
slug: /3DMath
title: 3D 数学
authors: Kaesar
---
1. **向量的点乘和叉乘**

- 点乘（数量积），其结果是一个标量，含义是一个向量在另一个向量方向上投影的长度。
- 叉乘（向量积），结果是一个向量，并且和已有两个向量都垂直。

  1、用向量计算公式对比：

  点乘：a · b = |a||b|cosθ

  叉乘：a × b = |a||b|sinθ

  2、二维坐标计算公式：

  设两个点 a = (x1, y1); b = (x2, y2);

  点乘：a · b = x1x2 + y1y2

  叉乘：a × b = x1y2 - x2y1 【结果看起来是个标量，其实是个伪向量，含义为所得向量的模】

  ​	    a × b = (x1y2, x2y1) 【向量结果】

  3、三维坐标计算公式：

  设两个点 a = (x1, y1, z1); b = (x2, y2, z2);

  点乘：a · b = x1x2 + y1y2 + z1z2

  叉乘：a × b = (y1z2 - y2z1, z1x2 - z2x1, x1y2 - x2y1)

  4、用途
  
  点乘：判断两个向量方向是否大体相同。
  a · b > 0 两者夹角 0 ~ 90 （方向大致相同）
  a · b = 0 两者夹角 90 （相互垂直）
  a · b < 0 两者夹角 90 ~ 180 （方向大致相反）
  
  叉乘：判断两个向量的位置关系：
  a × b > 0 a 在 b 的顺时针方向
  a × b = 0 a 与 b 共线，但方向不确定
  a × b < 0 a 在 b 逆时针方向
  
  **以 a, b 临边组成的平行四边形的面积**

2. **如何判断点在三角形内？**

   1. 叉乘：按照顺时针找到 ab，bc，ca 向量，按照左手定则，当 ab × ap > 0  bc × bp > 0 ca × cp > 0 都满足的时候，点在三角形内；当有一个叉乘结果为 0 的时候，点在三角形边上；当有一个值小于零的时候，点在三角形外边。
   2. 重心坐标：<img src="https://cdn.jsdelivr.net/gh/qzlu-cyber/PicgoLib@main/images/202403141542795.png" style="zoom:70%;" />

3. **判断一条光线是否与一个三角形相交**

   1. 几何法：先判断光线是否和三角形所在的面相交，再判断这个交点是否在三角形内，判断点是否在三角形内
      <img src="https://cdn.jsdelivr.net/gh/qzlu-cyber/PicgoLib@main/images/202403141439963.png" alt="几何法判断一条光线是否与一个三角形相交" style="zoom: 60%;"/>
   2. MT算法：光线的方程是：ray = origin + direction * t，如果一个点在三角形内，就能用重心坐标系去表示这个点；重心坐标公式，α = 1 – β - λ；带入方程，有3个未知数（β，λ，t），由因为都是三维变量，可以得到三个等式；利用克拉默法则，就可以求解出这三个未知数；解出来，判定t是否合理，t > 0，然后α、β和λ三个系数都是非负的，就是有解，在三角形内。

4. **点到直线的距离**

   （1）点到直线的距离公式

   （2）几何法：假设给出三个点，A，B 和 C，求点 C 到点 A、B 定出的直线间距离。首先计算向量 AB 和向量 AC叉乘的模长，得到由这两个向量构成的平行四边形的面积，再除以除 AB 的长度即可得到点到直线距离。

   d = |AB × AC| / |AB|

5. **两直线之间的距离**

   在一条直线上选取一个点，在另外一条直线选取两点，转化为计算点到直线距离。

6. **点到线段的距离**

   1. 转为向量问题，计算两个端点 AB、AP 组成的向量
   2. 计算 AP 在 AB 上的投影
   3. 判断 P 与 AB 的相对位置：

      - 如果投影 < 0，表示点 P 在点 A 的延长线上，此时距离为 P 到 A 的距离
      - 如果投影 > 0，表示点 P 在点 B 的延长线上，此时距离为 P 到 B 的距离
      - 否则 P 落在 AB 之间，通过距离公式求结果

        > |(x2-x1)(y1 - y0) - (x1-x0)(y2 - y1)| / |AB|
        >

7. **点到三角形的距离**

   1. 首先，计算点到三角形的三条边的距离。可以使用点到线段的距离公式来计算点到三角形三条边的距离。
   2. 然后，检查计算得到的距离，确定点是否在三角形的边界上。如果点在三角形的边界上，则点到三角形的距离为 0。
   3. 如果点不在三角形的边界上，接着计算点到三角形所在平面的距离。可以使用点到平面的距离公式来计算点到三角形所在平面的距离（在平面内找一点 A 计算 AP 在平面法线上的投影再取模）。
   4. 最后，根据点到三角形的三条边的距离以及点到三角形所在平面的距离，计算出点到三角形的最短距离。这个最短距离就是点到三角形的距离。

8. **如何判断射线是否与球相交？**

   （1）方程推导。

   （2）几何法：<img src="https://cdn.jsdelivr.net/gh/qzlu-cyber/PicgoLib@main/images/202403141454234.png" alt="几何法判断射线是否与球相交" />

9. **怎样判断两个矩形是否相交？**

   （1）边界法：

   对于两个这样的矩形 *A* 和 *B*，它们分别由左下角和右上角的点定义：*A* 的左下角为 A*left*，A*bottom*，右上角为 A*right*，A*top*；*B* 的左下角为 B*left*，B*bottom*，右上角为 B*left*，B*bottom*。

   <img src="https://cdn.jsdelivr.net/gh/qzlu-cyber/PicgoLib@main/images/202403141514221.png" alt="边界法判断两个矩形是否相交" style="zoom: 70%;" />

   （2）用两个矩形的中心坐标的向量来判断：

   假设两个矩形的中心为 p1、p2。那么其构成的向量 p1p2 的 x 分量的绝对值要小于两矩形长的一半，向量 p1p2 的 y 分量的绝对值要小于两矩形宽的一半。

10. **如何判断三角形是顺时针还是逆时针？**

   三角形两条边组成的向量叉乘，如果得到的结果 > 0，则为逆时针，否则为顺时针

   <img src="https://cdn.jsdelivr.net/gh/qzlu-cyber/PicgoLib@main/images/202403141540508.png" style="zoom:80%" />

11. **已知法线向量和入射向量求反射向量**

    <img src="https://cdn.jsdelivr.net/gh/qzlu-cyber/PicgoLib@main/images/202403141535445.png" alt="根据入射光线和法线计算反射光线" style="zoom:55%;" />
